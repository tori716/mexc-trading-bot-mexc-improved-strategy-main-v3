# バックテストシステム

このバックテストシステムは、MEXCトレーディングボットの戦略を過去の市場データで検証するためのツールです。

## 🚀 使用方法

### 1. 環境設定
```bash
# 環境変数の設定（.envファイルが必要）
cp env_template.sh .env
# .envファイルを編集してMEXC APIキーを設定

# 依存関係のインストール
pip install -r requirements.txt
pip install matplotlib  # チャート生成用
```

### 2. バックテストの実行
```bash
python run_backtest.py
```

### 3. 結果の確認
実行後、`backtest_results/`ディレクトリに以下のファイルが生成されます：

- `comprehensive_report_*.md` - 総合分析レポート（Markdown形式）
- `performance_analysis_*.png` - パフォーマンス比較チャート
- `equity_curves_*.png` - エクイティカーブ
- `1ヶ月_*.json`, `3ヶ月_*.json`, etc. - 各期間の詳細結果
- `all_results_*.json` - 全期間の結果まとめ

## 📊 バックテスト期間

以下の4つの期間で自動的にバックテストを実行します：

1. **1ヶ月** - 短期的なパフォーマンス評価
2. **3ヶ月** - 四半期パフォーマンス評価
3. **6ヶ月** - 半期パフォーマンス評価
4. **1年** - 年間パフォーマンス評価

## 📈 評価メトリクス

### 収益性指標
- **勝率** - 勝ちトレード数 ÷ 総トレード数
- **ROI (Return on Investment)** - 投資収益率
- **総収益** - 全トレードの損益合計

### リスク指標
- **最大ドローダウン** - 資産の最大下落率
- **シャープレシオ** - リスク調整後リターン
- **プロフィットファクター** - 総利益 ÷ 総損失

### トレード統計
- **平均勝ち/負け** - トレードごとの平均損益
- **最大勝ち/負け** - 単一トレードの最大損益
- **決済理由分析** - 各決済条件の発動頻度

## 🎯 パフォーマンス目標

本システムは以下の目標達成度を評価します：

| メトリクス | 目標値 |
|-----------|--------|
| 勝率 | ≥ 65% |
| 月間リターン | ≥ 65% |
| 最大ドローダウン | ≤ 15% |
| シャープレシオ | ≥ 2.5 |

## ⚙️ カスタマイズ

### 監視銘柄の変更
`config.py`で以下の変数を編集：
- `TARGET_SYMBOLS_TIER1`
- `TARGET_SYMBOLS_TIER2`
- `TARGET_SYMBOLS_TIER3`

### バックテスト期間の変更
`run_backtest.py`の`test_periods`リストを編集：
```python
test_periods = [
    ("2週間", 14),
    ("1ヶ月", 30),
    # 追加の期間...
]
```

## 📝 注意事項

1. **API制限**: MEXCのAPI制限により、大量の履歴データ取得には時間がかかります
2. **データ精度**: 5分足データを使用しているため、実際の約定価格とは差異が生じる可能性があります
3. **スリッページ**: バックテストではスリッページを考慮していません
4. **手数料**: テイカー手数料（0.05%）のみ考慮しています

## 🔧 トラブルシューティング

### データ取得エラー
- MEXC APIキーが正しく設定されているか確認
- インターネット接続を確認
- API制限に達していないか確認

### メモリエラー
- 監視銘柄数を減らす
- バックテスト期間を短くする

### チャート表示エラー
- `matplotlib`がインストールされているか確認
- 日本語フォントの問題の場合は、システムフォントを確認

## 📊 結果の解釈

### 良好な戦略の指標
- 勝率 > 60%
- シャープレシオ > 1.5
- 最大ドローダウン < 20%
- 安定したエクイティカーブ

### 改善が必要な指標
- 勝率 < 50%
- シャープレシオ < 1.0
- 最大ドローダウン > 30%
- 不安定なエクイティカーブ

## 🚀 次のステップ

バックテスト結果を基に：
1. パラメータの最適化
2. エントリー/エグジット条件の調整
3. リスク管理設定の見直し
4. 特定銘柄の除外/追加の検討

詳細な戦略調整は`strategy.py`と`config.py`を編集してください。