# バックテストシステム ドキュメント

## 📋 概要

このバックテストシステムは、MEXC取引ボットの戦略を過去データで検証するためのツールです。実際の取引を行う前に、戦略のパフォーマンスを評価し、リスクを把握することができます。

## 🚀 使用方法

### 基本的な実行方法

```bash
# 依存関係のインストール（初回のみ）
pip install -r requirements.txt

# バックテストの実行
python run_backtest.py
```

### 環境設定

バックテストを実行する前に、`.env`ファイルに以下の設定が必要です：

```bash
# MEXC API認証情報（履歴データ取得用）
MEXC_API_KEY=your_api_key_here
MEXC_SECRET_KEY=your_secret_key_here

# その他の設定はconfig.pyのデフォルト値が使用されます
```

## 📊 テスト期間

以下の4つの期間でバックテストが自動的に実行されます：

1. **1ヶ月**: 短期的なパフォーマンスの評価
2. **3ヶ月**: 四半期ベースの戦略効果測定
3. **6ヶ月**: 中期的なトレンドへの適応性確認
4. **1年**: 長期的な収益性と安定性の検証

## 📈 評価指標

### 基本指標

- **総取引数**: 期間中に実行された取引の総数
- **勝率**: 利益を出した取引の割合
- **総収益率**: 初期資金に対する最終的な収益率

### 高度な指標

- **シャープレシオ**: リスク調整後リターンの指標（1.0以上が望ましい）
- **最大ドローダウン**: 最大の資産減少率（20%以下が望ましい）
- **プロフィットファクター**: 総利益÷総損失（1.5以上が望ましい）
- **平均利益/損失**: 1取引あたりの平均損益

## 📁 出力ファイル

バックテスト実行後、`backtest_results/run_YYYYMMDD_HHMMSS/`ディレクトリに以下のファイルが生成されます：

### 1. comprehensive_report.md
- 全期間の総合分析レポート
- パフォーマンスサマリー
- 改善提案

### 2. [period]_results.json
- 各期間の詳細な取引データ
- 全ての指標値
- 個別取引の記録

### 3. performance_analysis.png
- 期間別パフォーマンスの視覚化
- 収益率、勝率、ドローダウン、シャープレシオの比較チャート

## ⚙️ カスタマイズ

### テスト対象銘柄の変更

`run_backtest.py`の以下の部分を編集：

```python
# 監視銘柄の設定
symbols = [s + "USDT" for s in config["TARGET_SYMBOLS_TIER1"]]
# 必要に応じてTIER2, TIER3を追加
```

### テスト期間の変更

```python
BACKTEST_PERIODS = {
    '1_week': 7,      # 1週間を追加
    '1_month': 30,
    '3_months': 90,
    '6_months': 180,
    '1_year': 365
}
```

## 🎯 パフォーマンス目標

良好な戦略の目安：

| 指標 | 目標値 | 優秀 |
|------|--------|------|
| 勝率 | > 50% | > 60% |
| シャープレシオ | > 1.0 | > 2.0 |
| 最大ドローダウン | < 20% | < 10% |
| プロフィットファクター | > 1.5 | > 2.0 |
| 月間収益率 | > 5% | > 10% |

## ⚠️ 注意事項

### バックテストの限界

1. **過去データの限界**
   - 過去のパフォーマンスは将来を保証しません
   - 市場環境の変化により結果が大きく異なる可能性があります

2. **実行の違い**
   - バックテストは理想的な約定を仮定
   - 実際の取引ではスリッページが発生
   - 流動性の問題により大口注文は約定しない可能性

3. **手数料とコスト**
   - テイカー手数料0.05%を考慮
   - ネットワーク遅延は考慮されていません

### 推奨事項

1. **段階的な導入**
   - まず少額でテスト運用
   - パフォーマンスを確認してから資金を増やす

2. **継続的な監視**
   - 定期的にバックテストを再実行
   - 市場環境の変化に応じてパラメータを調整

3. **リスク管理**
   - 最大ドローダウンを参考に資金管理
   - 複数の戦略でリスク分散

## 🔧 トラブルシューティング

### よくある問題

1. **APIエラー**
   ```
   エラー: MEXC APIから履歴データを取得できません
   ```
   **解決策**: API認証情報を確認し、レート制限に注意

2. **メモリ不足**
   ```
   エラー: MemoryError
   ```
   **解決策**: テスト期間を短くするか、銘柄数を減らす

3. **依存関係エラー**
   ```
   エラー: ModuleNotFoundError
   ```
   **解決策**: `pip install -r requirements.txt`を再実行

## 📞 サポート

問題が発生した場合：

1. エラーログを確認（`logs/bot.log`）
2. GitHubのIssueで報告
3. 設定値の見直し

## 🔄 更新履歴

- **v1.0.0** (2024-05-31): 初回リリース
  - 基本的なバックテスト機能
  - 4期間の自動テスト
  - レポート生成機能

---

**注意**: このドキュメントは継続的に更新されます。最新版はGitHubリポジトリをご確認ください。